---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { services, site } from "../../data/siteContent";
import type { GetStaticPaths } from "astro";

export const getStaticPaths: GetStaticPaths = () => {
  return services.map((service) => ({
    params: { slug: service.slug },
    props: { service },
  }));
};

export const prerender = true;

const { service } = Astro.props;

// Find related services (all except the current one)
const relatedServices = services.filter((s) => s.slug !== service.slug);
---

<BaseLayout
  title={`${service.title} (Forestry Mulching) | ${site.name}`}
  description={service.metaDescription}
>
  <!-- Hero -->
  <section class="relative w-full noise-overlay overflow-hidden">
    <div class="absolute inset-0 bg-[radial-gradient(ellipse_80%_50%_at_50%_0%,#1a2e1f_0%,#0B1411_60%)]"></div>
    <div class="relative z-10 container-main pt-16 pb-14 lg:pt-24 lg:pb-20">
      <!-- Breadcrumb -->
      <nav class="mb-6 text-sm" aria-label="Breadcrumb">
        <ol class="flex items-center gap-2 text-muted/60">
          <li><a href="/" class="hover:text-accent transition-colors">Home</a></li>
          <li class="text-border">/</li>
          <li><a href="/services" class="hover:text-accent transition-colors">Services</a></li>
          <li class="text-border">/</li>
          <li class="text-muted">{service.title}</li>
        </ol>
      </nav>

      <div class="text-center">
        <p class="text-olive2 text-xs font-heading font-semibold uppercase tracking-[0.18em] mb-3">
          Forestry Mulching
        </p>
        <h1 class="text-3xl sm:text-4xl lg:text-5xl font-heading font-bold text-text leading-[1.08]">
          {service.title.toUpperCase()}
        </h1>
        <p class="mt-5 text-muted text-base max-w-2xl mx-auto leading-relaxed">
          {service.description}
        </p>
      </div>
    </div>
    <div class="absolute bottom-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-border to-transparent"></div>
  </section>

  <!-- Service Image -->
  <section class="w-full bg-surface py-0">
    <div class="container-main">
      <div class="relative -mt-1 rounded-b-lg overflow-hidden border-x border-b border-border aspect-[21/9] max-h-[400px]">
        <img
          src={service.image}
          alt={service.title}
          class="w-full h-full object-cover"
          onerror="this.style.display='none'"
        />
        <div class="absolute inset-0 bg-gradient-to-t from-surface/60 to-transparent"></div>
      </div>
    </div>
  </section>

  <!-- Main Content -->
  <section class="w-full bg-surface py-16 lg:py-24">
    <div class="container-main">
      <div class="grid lg:grid-cols-3 gap-12 lg:gap-16">
        <!-- Left: Write-up -->
        <div class="lg:col-span-2">
          <div class="space-y-6 text-muted text-base leading-relaxed">
            {service.longDescription.map((paragraph: string) => (
              <p>{paragraph}</p>
            ))}
          </div>

          <!-- CTA inline -->
          <div class="mt-10 flex flex-col sm:flex-row items-start gap-4">
            <a href="/quote" class="btn btn-primary">
              Map Your Property &amp; Get Quote
            </a>
            <a
              href={`tel:${site.phone.replace(/\D/g, "")}`}
              class="text-accent text-sm font-semibold hover:text-accent2 transition-colors flex items-center gap-2 py-3"
            >
              <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
              </svg>
              {site.phone}
            </a>
          </div>
        </div>

        <!-- Right: Sidebar -->
        <div class="space-y-8">
          <!-- What's Included -->
          <div class="bg-surface2 border border-border rounded-lg p-6">
            <h3 class="font-heading font-bold text-base text-text uppercase tracking-wide mb-4">
              What's Included
            </h3>
            <ul class="space-y-3">
              {service.includes.map((item: string) => (
                <li class="flex items-start gap-3">
                  <svg class="w-5 h-5 text-olive2 shrink-0 mt-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
                  </svg>
                  <span class="text-muted text-sm leading-relaxed">{item}</span>
                </li>
              ))}
            </ul>
          </div>

          <!-- Quick Facts -->
          <div class="bg-surface2 border border-border rounded-lg p-6">
            <h3 class="font-heading font-bold text-base text-text uppercase tracking-wide mb-4">
              Quick Facts
            </h3>
            <dl class="space-y-3">
              <div>
                <dt class="text-muted/60 text-xs uppercase tracking-wider font-heading">Method</dt>
                <dd class="text-text text-sm font-medium">Professional Forestry Mulching</dd>
              </div>
              <div>
                <dt class="text-muted/60 text-xs uppercase tracking-wider font-heading">Turnaround</dt>
                <dd class="text-text text-sm font-medium">Most jobs 1â€“2 days</dd>
              </div>
              <div>
                <dt class="text-muted/60 text-xs uppercase tracking-wider font-heading">Pricing</dt>
                <dd class="text-text text-sm font-medium">By acreage + site conditions</dd>
              </div>
              <div>
                <dt class="text-muted/60 text-xs uppercase tracking-wider font-heading">Service Area</dt>
                <dd class="text-text text-sm font-medium">{site.serviceArea}</dd>
              </div>
            </dl>
          </div>

          <!-- Get Quote Box -->
          <div class="bg-accent/10 border border-accent/20 rounded-lg p-6 text-center">
            <p class="font-heading font-bold text-base text-text uppercase tracking-wide">
              Free Estimate
            </p>
            <p class="mt-2 text-muted text-sm leading-relaxed">
              Use our satellite map tool to draw your area and get a fast quote.
            </p>
            <a href="/quote" class="btn btn-primary w-full mt-4 !text-sm">
              Get Your Quote
            </a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Related Services -->
  <section class="w-full bg-bg py-16 lg:py-20">
    <div class="container-main">
      <div class="text-center mb-10">
        <h2 class="text-2xl sm:text-3xl font-heading font-bold text-text">
          OTHER FORESTRY MULCHING SERVICES
        </h2>
      </div>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5">
        {relatedServices.slice(0, 3).map((s) => (
          <a
            href={`/services/${s.slug}`}
            class="group block rounded-lg overflow-hidden bg-surface2 border border-border transition-all duration-[250ms] ease-out hover:-translate-y-1.5 hover:border-border-hover hover:shadow-[0_12px_40px_rgba(0,0,0,0.35),0_0_0_1px_rgba(200,163,105,0.15)]"
          >
            <div class="relative aspect-[16/10] overflow-hidden bg-gradient-to-br from-surface2 via-[#1a3028] to-surface">
              <img
                src={s.image}
                alt={s.title}
                class="w-full h-full object-cover opacity-90 group-hover:opacity-100 group-hover:scale-[1.03] transition-all duration-500"
                loading="lazy"
                onerror="this.style.display='none'"
              />
            </div>
            <div class="p-5">
              <h3 class="font-heading font-bold text-sm text-text uppercase tracking-wide group-hover:text-accent transition-colors duration-200">
                {s.title}
              </h3>
              <p class="mt-1.5 text-muted text-sm leading-relaxed line-clamp-2">
                {s.description}
              </p>
            </div>
          </a>
        ))}
      </div>
      <div class="mt-8 text-center">
        <a href="/services" class="text-accent text-sm font-semibold hover:text-accent2 transition-colors">
          View All Services &rarr;
        </a>
      </div>
    </div>
  </section>
</BaseLayout>
