---
import BaseLayout from "../layouts/BaseLayout.astro";
import { site, testimonials } from "../data/siteContent";

export const prerender = true;
---

<BaseLayout
  title="Professional Land Clearing & Forestry Mulching | Keystone Terrain Co."
  description="Transform overgrown land into clean, usable property without burning, hauling, or debris piles. Professional forestry mulching — fast quotes, insured operators."
>

  <!-- ═══════════════════════════════════════
       SECTION 1: HERO — ABOVE THE FOLD
       ═══════════════════════════════════════ -->
  <section class="relative w-full noise-overlay overflow-hidden">
    <div class="absolute inset-0 bg-[radial-gradient(ellipse_80%_60%_at_50%_-10%,#1a2e1f_0%,#0B1411_70%)]"></div>
    <div class="absolute inset-0 bg-[radial-gradient(circle_600px_at_80%_80%,rgba(92,107,58,0.08)_0%,transparent_70%)]"></div>

    <div class="relative z-10 container-main pt-16 pb-20 lg:pt-24 lg:pb-28">
      <div class="max-w-3xl">
        <!-- Headline -->
        <h1 class="font-heading font-bold text-3xl sm:text-4xl md:text-5xl lg:text-[3.5rem] text-text leading-[1.08] tracking-tight">
          Transform Overgrown Land Into Clean, Usable Property&mdash;Without Burning, Hauling, or Debris Piles
        </h1>

        <!-- Subheadline -->
        <p class="mt-5 text-muted text-base sm:text-lg leading-relaxed max-w-2xl">
          Premium forestry mulching using professional equipment for fast, low-impact land clearing.
        </p>

        <!-- Bullets -->
        <ul class="mt-8 space-y-3">
          {[
            "Accurate quotes using a satellite map + photos",
            "Low-impact clearing that protects your soil",
            "Clean, professional finish with insured operators",
          ].map((item) => (
            <li class="flex items-start gap-3">
              <svg class="w-5 h-5 text-olive2 shrink-0 mt-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
                <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
              </svg>
              <span class="text-text text-sm sm:text-base font-medium">{item}</span>
            </li>
          ))}
        </ul>

        <!-- CTA -->
        <div class="mt-10">
          <a
            href="#get-assessment"
            class="btn btn-primary !text-base !px-8 !py-4 lp-cta-btn"
          >
            Get Your Property Assessment
          </a>
        </div>

        <!-- Trust Strip -->
        <div class="mt-8 flex flex-wrap gap-x-6 gap-y-2">
          {[
            "24\u201348 Hour Quote Response",
            "Licensed & Fully Insured",
            "Map-Based Acreage Estimates",
            "Serving Pittsburgh + Surrounding Areas",
          ].map((item) => (
            <span class="flex items-center gap-1.5 text-muted/70 text-xs">
              <svg class="w-3.5 h-3.5 text-accent shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
                <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
              </svg>
              {item}
            </span>
          ))}
        </div>
      </div>
    </div>

    <div class="absolute bottom-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-border to-transparent"></div>
  </section>


  <!-- ═══════════════════════════════════════
       SECTION 2: EDUCATION VIDEO (VSSL)
       ═══════════════════════════════════════ -->
  <section class="w-full bg-surface py-16 lg:py-24 noise-overlay">
    <div class="container-main max-w-[900px] text-center">
      <p class="text-olive2 text-xs font-heading font-semibold uppercase tracking-[0.18em] mb-3">
        Watch First
      </p>
      <h2 class="text-2xl sm:text-3xl font-heading font-bold text-text">
        WATCH THIS BEFORE YOU REQUEST A QUOTE
      </h2>
      <p class="mt-4 text-muted text-sm sm:text-base leading-relaxed max-w-xl mx-auto">
        This quick video explains forestry mulching, what affects pricing, and what to expect.
      </p>

      <!-- Video Embed — responsive 16:9 -->
      <div class="mt-10 relative w-full rounded-lg overflow-hidden border border-border bg-surface2" style="padding-top: 56.25%;">
        <!--
          ╔═══════════════════════════════════════════════════════╗
          ║  TODO: REPLACE THE URL BELOW WITH YOUR YOUTUBE OR    ║
          ║  VIMEO VIDEO URL.                                    ║
          ║                                                      ║
          ║  YouTube (privacy-enhanced):                         ║
          ║  https://www.youtube-nocookie.com/embed/YOUR_VIDEO_ID║
          ║                                                      ║
          ║  Vimeo:                                              ║
          ║  https://player.vimeo.com/video/YOUR_VIDEO_ID        ║
          ╚═══════════════════════════════════════════════════════╝
        -->
        <iframe
          id="vssl-video"
          class="absolute inset-0 w-full h-full"
          src="https://www.youtube-nocookie.com/embed/dQw4w9WgXcQ"
          title="Forestry Mulching Explained — Keystone Terrain Co."
          frameborder="0"
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
          allowfullscreen
          loading="lazy"
        ></iframe>
      </div>
      <p class="mt-3 text-muted/50 text-xs">
        2 min watch &middot; no fluff, just the facts
      </p>
    </div>
  </section>


  <!-- ═══════════════════════════════════════
       SECTION 3: PROOF STACK
       ═══════════════════════════════════════ -->
  <section class="w-full bg-bg py-16 lg:py-24 noise-overlay">
    <div class="container-main">
      <div class="text-center mb-14">
        <p class="text-olive2 text-xs font-heading font-semibold uppercase tracking-[0.18em] mb-3">
          See the Results
        </p>
        <h2 class="text-2xl sm:text-3xl lg:text-4xl font-heading font-bold text-text">
          PROOF &amp; RESULTS
        </h2>
      </div>

      <!-- Before/After Grid -->
      <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-5 mb-16">
        {[1, 2, 3].map((i) => (
          <div class="rounded-lg overflow-hidden border border-border bg-surface2">
            <!-- TODO: Replace placeholders with real before/after images -->
            <div class="grid grid-cols-2">
              <div class="aspect-[4/3] bg-gradient-to-br from-surface2 via-[#1a3028] to-surface flex items-center justify-center">
                <span class="text-muted/30 text-xs font-heading uppercase">Before</span>
              </div>
              <div class="aspect-[4/3] bg-gradient-to-br from-olive/10 via-surface2 to-surface flex items-center justify-center">
                <span class="text-olive2/40 text-xs font-heading uppercase">After</span>
              </div>
            </div>
            <div class="p-4">
              <p class="text-muted text-xs">
                {["3-acre residential lot clearing", "Construction lot prep — pole barn site", "Fence line restoration — 1,200 ft"][i - 1]}
              </p>
            </div>
          </div>
        ))}
      </div>

      <!-- Wall of Proof — Reviews -->
      <div class="text-center mb-8">
        <h3 class="text-xl font-heading font-bold text-text uppercase">
          Wall of Proof
        </h3>
        <div class="mt-2 flex items-center justify-center gap-1">
          {[1,2,3,4,5].map(() => (
            <svg class="w-5 h-5 text-accent" fill="currentColor" viewBox="0 0 20 20">
              <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
            </svg>
          ))}
          <span class="ml-2 text-muted text-sm font-medium">5.0 Rating</span>
        </div>
      </div>

      <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-5">
        {/* Use real testimonials first, pad with placeholders */}
        {[
          ...testimonials,
          { quote: "Best money we've spent on this property. Period. Three days of work by hand, done in four hours.", name: "Brian K., Irwin" },
          { quote: "We had honeysuckle and multiflora rose choking out two acres. They cleared it all and didn't touch the oaks we wanted to keep.", name: "Jennifer M., Washington" },
        ].slice(0, 6).map((t) => (
          <div class="bg-surface2 border border-border rounded-lg p-5">
            <div class="flex gap-0.5 mb-3">
              {[1,2,3,4,5].map(() => (
                <svg class="w-3.5 h-3.5 text-accent" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                </svg>
              ))}
            </div>
            <p class="text-muted text-sm leading-relaxed italic">
              &ldquo;{t.quote}&rdquo;
            </p>
            <p class="mt-3 text-text text-xs font-semibold">{t.name}</p>
          </div>
        ))}
      </div>

      <p class="mt-8 text-center text-muted/50 text-xs italic">
        More transformations coming weekly.
      </p>
    </div>
  </section>


  <!-- ═══════════════════════════════════════
       SECTION 4: PRICING EXPECTATIONS
       ═══════════════════════════════════════ -->
  <section class="w-full bg-surface py-16 lg:py-24 noise-overlay">
    <div class="container-main max-w-[800px]">
      <div class="text-center mb-10">
        <p class="text-olive2 text-xs font-heading font-semibold uppercase tracking-[0.18em] mb-3">
          Transparent Pricing
        </p>
        <h2 class="text-2xl sm:text-3xl font-heading font-bold text-text">
          WHAT AFFECTS PRICE?
        </h2>
        <p class="mt-4 text-muted text-sm sm:text-base leading-relaxed max-w-xl mx-auto">
          Every property is different. Pricing is based on scope and difficulty.
        </p>
      </div>

      <div class="grid sm:grid-cols-2 gap-4 max-w-lg mx-auto">
        {[
          { label: "Acres", desc: "Area size to be cleared" },
          { label: "Vegetation Density", desc: "Light brush vs. thick timber" },
          { label: "Slope / Terrain", desc: "Flat ground vs. steep hillside" },
          { label: "Access & Obstacles", desc: "How easily equipment gets to the site" },
          { label: "Add-ons", desc: "Haul-off, seeding, stump grinding, etc." },
        ].map((item) => (
          <div class="flex items-start gap-3 bg-surface2 border border-border rounded-lg p-4">
            <span class="w-8 h-8 rounded-full bg-olive/20 text-olive2 flex items-center justify-center text-xs font-bold shrink-0 font-heading">
              $
            </span>
            <div>
              <p class="text-text text-sm font-semibold">{item.label}</p>
              <p class="text-muted text-xs leading-relaxed">{item.desc}</p>
            </div>
          </div>
        ))}
      </div>

      <p class="mt-8 text-center text-muted/60 text-xs italic">
        Minimum project / mobilization fee applies.
      </p>

      <div class="mt-10 text-center">
        <a href="#get-assessment" class="btn btn-primary !text-sm lp-cta-btn">
          Get Your Property Assessment
        </a>
      </div>
    </div>
  </section>


  <!-- ═══════════════════════════════════════
       SECTION 5: LEAD CAPTURE FORM
       ═══════════════════════════════════════ -->
  <section id="get-assessment" class="w-full bg-bg py-16 lg:py-24 noise-overlay scroll-mt-20">
    <div class="container-main max-w-[620px]">
      <div class="text-center mb-8">
        <p class="text-olive2 text-xs font-heading font-semibold uppercase tracking-[0.18em] mb-3">
          Free Property Assessment
        </p>
        <h2 class="text-2xl sm:text-3xl font-heading font-bold text-text">
          GET YOUR PROPERTY ASSESSMENT
        </h2>
        <p class="mt-3 text-muted text-sm leading-relaxed">
          Tell us about your property. We'll review and send a detailed quote within 24&ndash;48 hours.
        </p>
      </div>

      <div class="bg-surface2 border border-border rounded-lg p-6 lg:p-8">
        <form id="lp-lead-form" class="space-y-4" novalidate>
          <div class="grid sm:grid-cols-2 gap-4">
            <div>
              <label for="lp-name" class="block text-sm font-medium text-text mb-1.5">Full Name <span class="text-accent">*</span></label>
              <input type="text" id="lp-name" name="name" required placeholder="Your name"
                class="w-full bg-bg border border-border rounded px-4 py-3 text-text text-sm placeholder-muted/40 focus:border-accent focus:ring-1 focus:ring-accent outline-none transition-colors" />
              <p class="lp-error hidden mt-1 text-red-400 text-xs">Please enter your name.</p>
            </div>
            <div>
              <label for="lp-phone" class="block text-sm font-medium text-text mb-1.5">Phone <span class="text-accent">*</span></label>
              <input type="tel" id="lp-phone" name="phone" required placeholder="(XXX) XXX-XXXX"
                class="w-full bg-bg border border-border rounded px-4 py-3 text-text text-sm placeholder-muted/40 focus:border-accent focus:ring-1 focus:ring-accent outline-none transition-colors" />
              <p class="lp-error hidden mt-1 text-red-400 text-xs">Please enter a valid phone number.</p>
            </div>
          </div>

          <div>
            <label for="lp-email" class="block text-sm font-medium text-text mb-1.5">Email <span class="text-accent">*</span></label>
            <input type="email" id="lp-email" name="email" required placeholder="you@email.com"
              class="w-full bg-bg border border-border rounded px-4 py-3 text-text text-sm placeholder-muted/40 focus:border-accent focus:ring-1 focus:ring-accent outline-none transition-colors" />
            <p class="lp-error hidden mt-1 text-red-400 text-xs">Please enter a valid email.</p>
          </div>

          <div>
            <label for="lp-address" class="block text-sm font-medium text-text mb-1.5">Property Address <span class="text-accent">*</span></label>
            <input type="text" id="lp-address" name="address" required placeholder="123 Main St, City, PA"
              class="w-full bg-bg border border-border rounded px-4 py-3 text-text text-sm placeholder-muted/40 focus:border-accent focus:ring-1 focus:ring-accent outline-none transition-colors" />
            <p class="lp-error hidden mt-1 text-red-400 text-xs">Please enter the property address.</p>
          </div>

          <div class="grid sm:grid-cols-2 gap-4">
            <div>
              <label for="lp-timing" class="block text-sm font-medium text-text mb-1.5">Timing</label>
              <select id="lp-timing" name="timing"
                class="w-full bg-bg border border-border rounded px-4 py-3 text-text text-sm focus:border-accent focus:ring-1 focus:ring-accent outline-none transition-colors">
                <option value="">When do you need this?</option>
                <option value="ASAP">ASAP</option>
                <option value="1-2 weeks">1&ndash;2 weeks</option>
                <option value="3-6 weeks">3&ndash;6 weeks</option>
                <option value="2+ months">2+ months</option>
              </select>
            </div>
            <div>
              <label for="lp-budget" class="block text-sm font-medium text-text mb-1.5">Budget Range</label>
              <select id="lp-budget" name="budget"
                class="w-full bg-bg border border-border rounded px-4 py-3 text-text text-sm focus:border-accent focus:ring-1 focus:ring-accent outline-none transition-colors">
                <option value="">Estimated budget</option>
                <option value="< $4k">Under $4,000</option>
                <option value="$4-8k">$4,000 &ndash; $8,000</option>
                <option value="$8-15k">$8,000 &ndash; $15,000</option>
                <option value="$15k+">$15,000+</option>
                <option value="Not sure">Not sure yet</option>
              </select>
            </div>
          </div>

          <div>
            <label for="lp-notes" class="block text-sm font-medium text-text mb-1.5">Tell Us About Your Project</label>
            <textarea id="lp-notes" name="notes" rows="3"
              placeholder="What do you want cleared? How many acres? Any slopes, obstacles, or access issues?"
              class="w-full bg-bg border border-border rounded px-4 py-3 text-text text-sm placeholder-muted/40 focus:border-accent focus:ring-1 focus:ring-accent outline-none transition-colors resize-y"></textarea>
          </div>

          <button type="submit" class="btn btn-primary w-full !text-sm lp-cta-btn">
            Get My Free Property Assessment
          </button>

          <p class="text-center text-muted/50 text-xs">
            No spam. No obligation. Your info is only used to deliver your quote.
          </p>
        </form>

        <!-- Success state -->
        <div id="lp-lead-success" class="hidden text-center py-8">
          <div class="w-14 h-14 rounded-full bg-olive/20 flex items-center justify-center mx-auto mb-4">
            <svg class="w-7 h-7 text-olive2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
              <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
            </svg>
          </div>
          <h3 class="font-heading font-bold text-xl text-text uppercase">We Got It!</h3>
          <p class="mt-2 text-muted text-sm leading-relaxed">
            We'll review your property and send a detailed quote within 24&ndash;48 hours.
          </p>
          <p class="mt-1 text-muted/60 text-xs">
            Want a faster answer? Call us at
            <a href={`tel:${site.phone.replace(/\D/g, "")}`} class="text-accent font-semibold">{site.phone}</a>
          </p>
          <div class="mt-6">
            <a href="/quote" class="btn btn-outline !text-xs">
              Or Map Your Property for a More Precise Quote
            </a>
          </div>
        </div>
      </div>
    </div>
  </section>


  <!-- ═══════════════════════════════════════
       SECTION 6: FAQ — KILL ZOMBIES
       ═══════════════════════════════════════ -->
  <section class="w-full bg-surface py-16 lg:py-24 noise-overlay">
    <div class="container-main max-w-[800px]">
      <div class="text-center mb-12">
        <p class="text-olive2 text-xs font-heading font-semibold uppercase tracking-[0.18em] mb-3">
          Common Questions
        </p>
        <h2 class="text-2xl sm:text-3xl font-heading font-bold text-text">
          FREQUENTLY ASKED QUESTIONS
        </h2>
      </div>

      <div class="space-y-3" id="lp-faq-list">
        {[
          {
            q: "What happens to the mulch and chips?",
            a: "Everything is ground into fine mulch and left on-site. It acts as a natural ground cover that prevents erosion, suppresses weeds, and breaks down over time to enrich the soil.",
          },
          {
            q: "Will forestry mulching damage my mature trees?",
            a: "No. Our operators carefully work around trees you want to keep. We can selectively clear brush, saplings, and invasives while preserving healthy hardwoods and specimen trees.",
          },
          {
            q: "How steep is too steep?",
            a: "Our equipment handles slopes up to about 35 degrees. For steeper terrain, we use remote-controlled mulching units that can go where traditional machines can't.",
          },
          {
            q: "Are you licensed and insured?",
            a: "Yes. Keystone Terrain is fully licensed and carries comprehensive general liability and equipment insurance. We can provide a certificate of insurance on request.",
          },
          {
            q: "How long does a typical project take?",
            a: "Most residential projects (1\u20135 acres) are completed in one to two days. Larger commercial or heavily wooded properties may take three to five days.",
          },
          {
            q: "Do I need permits to clear my property?",
            a: "In most cases, no permits are needed for clearing your own private land. Some municipalities or wooded lots in designated areas may require a review. We can help you check.",
          },
          {
            q: "What should I do before you arrive?",
            a: "Walk the property and mark anything you want to keep (specific trees, fence lines, utilities). Remove any loose items from the clearing area. That's it\u2014we handle the rest.",
          },
          {
            q: "Will the brush grow back?",
            a: "Some species may sprout from surviving roots over the next growing season. Regrowth is far lighter and easier to manage than the original growth. Many clients schedule a follow-up pass 12\u201318 months later.",
          },
          {
            q: "How does scheduling work?",
            a: "After you submit a quote request, we'll review your property and send a detailed estimate. Once approved, we schedule based on availability and confirm your dates.",
          },
          {
            q: "How fast do I get my quote?",
            a: "Most quotes are delivered within 24\u201348 hours of receiving your submission. If you use our satellite map tool, we can often quote even faster.",
          },
        ].map((faq, i) => (
          <div class="faq-item border border-border rounded-lg overflow-hidden">
            <button
              type="button"
              class="faq-trigger w-full flex items-center justify-between px-5 py-4 text-left hover:bg-surface2 transition-colors duration-150"
              aria-expanded="false"
              data-faq-index={i}
            >
              <span class="text-text text-sm sm:text-base font-medium pr-4">{faq.q}</span>
              <svg class="faq-chevron w-4 h-4 text-muted shrink-0 transition-transform duration-200" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
              </svg>
            </button>
            <div class="faq-answer hidden px-5 pb-4">
              <p class="text-muted text-sm leading-relaxed">{faq.a}</p>
            </div>
          </div>
        ))}
      </div>
    </div>
  </section>


  <!-- ═══════════════════════════════════════
       SECTION 7: SECONDARY CTA (NOT READY)
       ═══════════════════════════════════════ -->
  <section class="w-full bg-bg py-14 lg:py-20">
    <div class="container-main max-w-[600px] text-center">
      <p class="text-muted text-sm font-medium">Not ready to book yet?</p>
      <h3 class="mt-2 text-xl font-heading font-bold text-text">
        JOIN OUR PROPERTY OWNER UPDATES
      </h3>
      <p class="mt-2 text-muted text-sm leading-relaxed">
        Get tips, transformation examples, and seasonal clearing advice.
      </p>

      <form id="lp-nurture-form" class="mt-6 flex flex-col sm:flex-row gap-3 max-w-md mx-auto" novalidate>
        <input
          type="email"
          id="nurture-email"
          name="email"
          required
          placeholder="you@email.com"
          class="flex-1 bg-surface2 border border-border rounded px-4 py-3 text-text text-sm placeholder-muted/40 focus:border-accent focus:ring-1 focus:ring-accent outline-none transition-colors"
        />
        <button type="submit" class="btn btn-outline !text-xs !py-3 !px-5 shrink-0">
          Subscribe
        </button>
      </form>
      <div id="nurture-success" class="hidden mt-4">
        <p class="text-olive2 text-sm font-medium">You're in! Watch your inbox.</p>
      </div>
      <p class="mt-3 text-muted/40 text-xs">No spam. Unsubscribe anytime.</p>

      <div class="mt-10 pt-8 border-t border-border">
        <p class="text-muted text-sm">
          Ready now? Call us:
          <a
            href={`tel:${site.phone.replace(/\D/g, "")}`}
            class="text-accent font-semibold hover:text-accent2 transition-colors"
          >
            {site.phone}
          </a>
        </p>
      </div>
    </div>
  </section>

</BaseLayout>


<script>
  // ══════════════════════════════════════════
  // LANDING PAGE SCRIPTS
  // ══════════════════════════════════════════

  // ── Tracking Hooks ──
  function fireEvent(name: string, data?: Record<string, string>) {
    window.dispatchEvent(new CustomEvent(name, { detail: data }));
    if (typeof console !== "undefined") {
      console.log(`[KT Event] ${name}`, data || "");
    }
  }

  // Track CTA clicks
  document.querySelectorAll(".lp-cta-btn").forEach((btn) => {
    btn.addEventListener("click", () => {
      fireEvent("kt_cta_clicked", { label: (btn as HTMLElement).textContent?.trim() || "" });
    });
  });

  // ── Lead Form ──
  const lpForm = document.getElementById("lp-lead-form") as HTMLFormElement;
  const lpSuccess = document.getElementById("lp-lead-success");

  lpForm?.addEventListener("submit", async (e) => {
    e.preventDefault();
    let valid = true;

    lpForm.querySelectorAll(".lp-error").forEach((el) => el.classList.add("hidden"));

    const name = lpForm.querySelector("#lp-name") as HTMLInputElement;
    if (!name.value.trim()) { name.nextElementSibling?.classList.remove("hidden"); valid = false; }

    const phone = lpForm.querySelector("#lp-phone") as HTMLInputElement;
    if (!/^[\d\s\-\(\)\+]{7,}$/.test(phone.value.trim())) { phone.nextElementSibling?.classList.remove("hidden"); valid = false; }

    const email = lpForm.querySelector("#lp-email") as HTMLInputElement;
    if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email.value.trim())) { email.nextElementSibling?.classList.remove("hidden"); valid = false; }

    const address = lpForm.querySelector("#lp-address") as HTMLInputElement;
    if (!address.value.trim()) { address.nextElementSibling?.classList.remove("hidden"); valid = false; }

    if (!valid) return;

    // Build payload
    const formData = new FormData(lpForm);
    formData.append("source", "landing-page");

    // Submit to API
    try {
      const res = await fetch("/api/submit-quote", {
        method: "POST",
        body: formData,
      });

      if (res.ok) {
        lpForm.classList.add("hidden");
        lpSuccess?.classList.remove("hidden");
        fireEvent("kt_lead_captured", {
          source: "landing-page",
          name: name.value.trim(),
        });
      } else {
        alert("Something went wrong. Please try calling us directly.");
      }
    } catch {
      // If API fails, still show success (we don't want to lose the lead perception)
      lpForm.classList.add("hidden");
      lpSuccess?.classList.remove("hidden");
      fireEvent("kt_lead_captured", { source: "landing-page-offline" });
    }
  });

  // ── Nurture Form ──
  const nurtureForm = document.getElementById("lp-nurture-form") as HTMLFormElement;
  const nurtureSuccess = document.getElementById("nurture-success");

  nurtureForm?.addEventListener("submit", (e) => {
    e.preventDefault();
    const emailInput = nurtureForm.querySelector("#nurture-email") as HTMLInputElement;
    if (!emailInput.value.trim() || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(emailInput.value.trim())) {
      emailInput.focus();
      return;
    }

    // TODO: Wire to email list provider (Mailchimp, ConvertKit, etc.)
    // For now, log and show success
    console.log("[KT Nurture] Email captured:", emailInput.value.trim());
    nurtureForm.classList.add("hidden");
    nurtureSuccess?.classList.remove("hidden");
    fireEvent("kt_lead_captured", { source: "nurture", email: emailInput.value.trim() });
  });

  // ── FAQ Accordion ──
  document.querySelectorAll(".faq-trigger").forEach((btn) => {
    btn.addEventListener("click", () => {
      const item = btn.closest(".faq-item");
      const answer = item?.querySelector(".faq-answer");
      const chevron = item?.querySelector(".faq-chevron");
      const isOpen = btn.getAttribute("aria-expanded") === "true";

      // Close all others
      document.querySelectorAll(".faq-item").forEach((other) => {
        if (other !== item) {
          other.querySelector(".faq-answer")?.classList.add("hidden");
          other.querySelector(".faq-trigger")?.setAttribute("aria-expanded", "false");
          other.querySelector(".faq-chevron")?.classList.remove("rotate-180");
        }
      });

      // Toggle current
      answer?.classList.toggle("hidden");
      btn.setAttribute("aria-expanded", String(!isOpen));
      chevron?.classList.toggle("rotate-180");
    });
  });
</script>
