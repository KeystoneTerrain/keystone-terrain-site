---
import Section from "./Section.astro";
import { site } from "../data/siteContent";
---

<Section id="quote" bg="bg-surface" noise>
  <div class="grid lg:grid-cols-2 gap-12 lg:gap-20 items-start">

    <!-- Left: Intro Copy -->
    <div>
      <p class="text-olive2 text-xs font-heading font-semibold uppercase tracking-[0.18em] mb-3">
        Free Estimate
      </p>
      <h2 class="text-3xl sm:text-4xl font-heading font-bold text-text leading-[1.08]">
        GET YOUR FREE QUOTE
      </h2>
      <p class="mt-5 text-muted text-base leading-relaxed">
        Tell us about your property and we'll provide a fast, accurate estimate.
        Most quotes delivered within 24–48 hours.
      </p>

      <!-- Trust & Process Block -->
      <div class="mt-8 bg-surface2 border border-border rounded-lg p-5">
        <p class="font-heading font-bold text-sm text-text uppercase tracking-wide mb-4">
          Trust &amp; Process
        </p>
        <ul class="space-y-3">
          {[
            "24–48 Hour Quote Response",
            "Licensed & Fully Insured Operators",
            "Map-Based Acreage Estimates",
            "Forestry Mulching Specialists",
          ].map((item) => (
            <li class="flex items-start gap-2.5">
              <svg class="w-4 h-4 text-accent shrink-0 mt-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
                <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
              </svg>
              <span class="text-muted text-sm leading-relaxed">{item}</span>
            </li>
          ))}
        </ul>
      </div>

      <ul class="mt-6 space-y-4">
        {[
          "No-obligation quotes — fast and accurate",
          "We assess brush density, slope, and access",
          "Licensed, insured, and locally owned",
          "Scheduling based on availability — we'll confirm next open dates after review",
        ].map((item) => (
          <li class="flex items-start gap-3">
            <svg class="w-5 h-5 text-olive2 shrink-0 mt-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path d="M5 13l4 4L19 7" />
            </svg>
            <span class="text-muted text-sm leading-relaxed">{item}</span>
          </li>
        ))}
      </ul>

      <!-- Minimum Job Notice -->
      <p class="mt-6 text-muted/50 text-xs italic leading-relaxed">
        Minimum project / mobilization fee applies (based on location and scope).
      </p>

      <!-- Contact info -->
      <div class="mt-10 pt-8 border-t border-border space-y-3">
        <a
          href={`tel:${site.phone.replace(/\D/g, "")}`}
          class="flex items-center gap-2 text-accent text-sm font-semibold hover:text-accent2 transition-colors duration-200"
        >
          <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
          </svg>
          {site.phone}
        </a>
        <a
          href={`mailto:${site.email}`}
          class="flex items-center gap-2 text-muted text-sm hover:text-accent transition-colors duration-200"
        >
          <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
          </svg>
          {site.email}
        </a>
      </div>
    </div>

    <!-- Right: Form -->
    <div>
      <form id="quote-form" class="space-y-5" novalidate>
        <div>
          <label for="q-name" class="block text-sm font-medium text-text mb-1.5">
            Name
          </label>
          <input
            type="text"
            id="q-name"
            name="name"
            required
            placeholder="Your name"
            class="w-full bg-bg border border-border rounded px-4 py-3 text-text text-sm placeholder-muted/40 focus:border-accent focus:ring-1 focus:ring-accent outline-none transition-colors duration-200"
          />
          <p class="form-error hidden mt-1 text-red-400 text-xs">Please enter your name.</p>
        </div>

        <div>
          <label for="q-phone" class="block text-sm font-medium text-text mb-1.5">
            Phone
          </label>
          <input
            type="tel"
            id="q-phone"
            name="phone"
            required
            placeholder="(XXX) XXX-XXXX"
            class="w-full bg-bg border border-border rounded px-4 py-3 text-text text-sm placeholder-muted/40 focus:border-accent focus:ring-1 focus:ring-accent outline-none transition-colors duration-200"
          />
          <p class="form-error hidden mt-1 text-red-400 text-xs">Please enter a valid phone number.</p>
        </div>

        <div>
          <label for="q-email" class="block text-sm font-medium text-text mb-1.5">
            Email
          </label>
          <input
            type="email"
            id="q-email"
            name="email"
            required
            placeholder="you@email.com"
            class="w-full bg-bg border border-border rounded px-4 py-3 text-text text-sm placeholder-muted/40 focus:border-accent focus:ring-1 focus:ring-accent outline-none transition-colors duration-200"
          />
          <p class="form-error hidden mt-1 text-red-400 text-xs">Please enter a valid email address.</p>
        </div>

        <div>
          <label for="q-message" class="block text-sm font-medium text-text mb-1.5">
            Property Details / Message
          </label>
          <textarea
            id="q-message"
            name="message"
            rows="5"
            required
            placeholder="Tell us about your property — location, acreage, type of vegetation, terrain, and what you'd like to accomplish."
            class="w-full bg-bg border border-border rounded px-4 py-3 text-text text-sm placeholder-muted/40 focus:border-accent focus:ring-1 focus:ring-accent outline-none transition-colors duration-200 resize-y"
          ></textarea>
          <p class="form-error hidden mt-1 text-red-400 text-xs">Please describe your project.</p>
        </div>

        <button type="submit" class="btn btn-primary w-full sm:w-auto">
          Get Free Quote
        </button>
      </form>

      <!-- Success Message (hidden by default) -->
      <div id="form-success" class="hidden mt-6 bg-olive/15 border border-olive/30 rounded-lg p-5 text-center">
        <p class="text-olive2 font-semibold text-base">Thanks — we'll reach out shortly.</p>
        <p class="text-muted text-sm mt-1">Expect a call or email within 24–48 hours.</p>
      </div>
    </div>
  </div>
</Section>

<script>
  const form = document.getElementById("quote-form") as HTMLFormElement;
  const success = document.getElementById("form-success");

  form?.addEventListener("submit", (e) => {
    e.preventDefault();
    let valid = true;

    // Reset errors
    form.querySelectorAll(".form-error").forEach((el) => el.classList.add("hidden"));

    const name = form.querySelector("#q-name") as HTMLInputElement;
    if (!name.value.trim()) {
      name.nextElementSibling?.classList.remove("hidden");
      valid = false;
    }

    const phone = form.querySelector("#q-phone") as HTMLInputElement;
    if (!/^[\d\s\-\(\)\+]{7,}$/.test(phone.value.trim())) {
      phone.nextElementSibling?.classList.remove("hidden");
      valid = false;
    }

    const email = form.querySelector("#q-email") as HTMLInputElement;
    if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email.value.trim())) {
      email.nextElementSibling?.classList.remove("hidden");
      valid = false;
    }

    const message = form.querySelector("#q-message") as HTMLTextAreaElement;
    if (!message.value.trim()) {
      message.nextElementSibling?.classList.remove("hidden");
      valid = false;
    }

    if (valid) {
      form.classList.add("hidden");
      success?.classList.remove("hidden");
    }
  });
</script>
